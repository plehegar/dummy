name: Learning GitHub actions

# Reference documentation: https://docs.github.com/en/actions/reference

# See https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#onpushpull_requestbranchestags
on:
  push:
    branches:
      - main

jobs:

# All of the following jobs will run in parallel

  use-node:
    name: Using NodeJS
    runs-on: ubuntu-latest
    steps:
      # the following step will checkout your github repository
      - uses: actions/checkout@v2
      # the following step will install nodejs, including npm
      - uses: actions/setup-node@v2
      - run: npm install
      - run: npm start

  use-script:
    name: Using a shell script
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      # don't forget: git update-index --chmod +x ./.github/scripts/build.sh
      - run: ./.github/scripts/build.sh
        shell: bash

  use-script-2:
    name: Using a shell script inline
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: |
          cd foobar
          echo $PWD
        shell: bash

  use-java:
    name: Using a java program
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup Java
        # note that this is also deploy ant
        uses: actions/setup-java@v2
        with:
          distribution: 'adopt'
          java-version: '11'
      - run: java -cp java HelloWorld

  use-python:
    runs-on: ubuntu-latest
    name: Using a python script
    steps:
      - uses: actions/checkout@v2
      - name: Setup python
        uses: actions/setup-python@v2
        with:
          python-version: 3.6
          architecture: x64
      - run: pip install aiohttp
      - run: python index.py

# this is an example when combining use-scruipt and use-python
  use-script-and-python:
    runs-on: ubuntu-latest
    name: Using a shell and a python script
    steps:
      - uses: actions/checkout@v2
      - name: Setup python
        uses: actions/setup-python@v2
        with:
          python-version: 3.6
          architecture: x64
      # don't forget: git update-index --chmod +x ./python.sh
      - name: Run the script that invokes python
        run: ./python.sh
        shell: bash

  use-w3c-echidna:
    runs-on: ubuntu-latest
    name: Use echidna as-is
    steps:
      - uses: actions/checkout@v2
      - name: Run curl
        run: |
        curl "https://labs.w3.org/echidna/api/request" --data "url=https://example.org/index.html" --data "decision=none" --data "token=NO_SECRET_FOR_YOU";
        echo "ok"

  use-irc:
    runs-on: ubuntu-latest
    name: Notifying IRC
    steps:
      - name: Setup IRC notifier
        uses: Gottox/irc-message-action@v2
        with:
          channel: '#github-irc-notify'
          server: irc.w3.org
          port: 6667
          tls: false
          nickname: github-action-irc
          message: |
            ${{ github.actor }} pushed to ${{ github.repository }} commit ${{ github.sha }}

  use-deploy-script:
    name: Using a shell script to deploy a build folder on a GitHub branch
    runs-on: ubuntu-latest
    env:
      FOLDER: deploybuild
    steps:
      - uses: actions/checkout@v2
      # don't forget: git update-index --chmod +x ./.github/scripts/build-output.sh
      - name: Run the build-output.sh script
        run: ./.github/scripts/build-output.sh
        shell: bash
      - name: Deploy
        uses: s0/git-publish-subdir-action@develop
        env:
          REPO: self
          BRANCH: gh-pages
          # FOLDER is already set up so no need to repeat here
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
